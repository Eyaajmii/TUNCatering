<div class="content">
    <div class="container">
      <div *ngIf="loading" class="loading-indicator">
        Chargement des commandes...
      </div>
      <div class="export-container">
        <button (click)="exportToExcel()" class="export-button">
          <i class="bi bi-file-earmark-excel-fill me-1"></i> Exporter en Excel
        </button>
      </div>
      <div class="filters mb-3">
        <select [(ngModel)]="filtres.statut" class="form-control">
          <option value="tous">Toutes les commandes</option>
          <option *ngFor="let status of availableStatuses" [value]="status.value">
            {{ status.display }}
          </option>
        </select>
      </div>
      <div class="card ">
        <div class="card-header bg-white border-bottom-0 ">
          <h3 class="mb-0 fw-bold">LISTE DES COMMANDES</h3>
        </div>
      <div class="table-responsive">
        <table class="table table-striped custom-table">
          <thead class="thead">
            <tr>
              <th scope="col">NÂ° commande</th>
              <th scope="col">Vol</th>
              <th scope="col">Matricule </th>
              <th scope="col">Commande</th>
              <th scope="col">Nombre</th>
              <th scope="col">Statut</th>
              <th scope="col">Actions</th>
            </tr>
          </thead>
          <tbody *ngIf="!loading && !error">
            <tr *ngFor="let commande of filteredCommands">
              <td class="fw-semibold text-primary">
                {{commande.numeroCommande  }}
              </td>
              <td>{{ commande.vol?.numVol }}</td>
              <td>                
                <div>{{ commande.Matricule }}</div>
              </td>            
            
              <td>
                <strong>{{ commande.menu?.nom  }}</strong>
                <ul>
                  <li *ngFor="let plat of commande.plats">
                    {{ plat.nom }}
                  </li>
                </ul>
              </td>
              <td>{{ commande.NombreCommande }}</td>
              <td [ngClass]="getStatusClass(commande.Statut)">
                {{commande.Statut}}
              </td>
              <td>
                <button type="submit" (click)="annuler(commande._id)" class="btn btn-sm btn-danger"> Annuler </button>
              </td>                      
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  