<div class="container">
  <div *ngIf="loading" class="text-center mt-3">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
  </div>

  <div *ngIf="error" class="alert alert-danger text-center">
    {{ error }}
  </div>
  <div class=" filters mb-3">
    <select id="filtreStatut"  [(ngModel)]="selectedStatut">
      <option value="Tous">Tous</option>
      <option value="en attente">En attente</option>
      <option value="traité">Traitée</option>
      <option value="annulée">Annulée</option>
    </select>
  </div>
  <div *ngIf="!loading && !error" class="card mt-3">
    <div class="card-header">
      <h3>LISTE DES RÉCLAMATIONS</h3>
    </div>
    <div class="card-body">
      <table class="table table-bordered table-hover">
        <thead>
          <tr>
            <th>N° Réclamation</th>
            <th>Objet</th>
            <th>Message</th>
            <th>Réponse</th>
            <th>Statut</th>
            <th>Nouvelle Réponse</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of ReclamationFiltres">
            <td>{{ r.NumeroReclamation }}</td>
            <td>{{ r.Objet }}</td>
            <td>{{ r.MessageEnvoye }}</td>
            <td>{{ r.MessageReponse || 'Pas encore de réponse' }}</td>
            <td>
              <select 
                [(ngModel)]="r.Statut" 
                [ngClass]="getStatusClass(r.Statut)">
                <option *ngFor="let status of availableStatuses" [value]="status.value">
                  {{ status.display }}
                </option>
              </select>
            </td> 
            <td>
              <textarea [(ngModel)]="r.MessageReponse" rows="2" placeholder="Répondre..."></textarea>
            </td>  
            <td>
              <button class="btn btn-primary btn-sm" (click)="changer(r._id, r.Statut, r.MessageReponse)">
                Valider
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
